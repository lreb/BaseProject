<div class="form-container">
  <header class="form-header">
    <h1>{{ isEditMode ? 'Editar Producto' : 'Nuevo Producto' }}</h1>
    <button class="btn-back" (click)="onCancel()">← Volver</button>
  </header>

  <!-- Error general -->
  <div *ngIf="error$ | async as error" class="error-message">
    <p>❌ {{ error.message || 'Error al procesar la solicitud' }}</p>
  </div>

  <form [formGroup]="productForm" (ngSubmit)="onSubmit()" class="product-form">
    
    <!-- Nombre -->
    <div class="form-group">
      <label for="name">Nombre del Producto *</label>
      <input 
        type="text" 
        id="name" 
        formControlName="name"
        [class.invalid]="isFieldInvalid('name')"
        placeholder="Ej: Laptop HP">
      <span class="error-text" *ngIf="isFieldInvalid('name')">
        {{ getFieldError('name') }}
      </span>
    </div>

    <!-- Descripción -->
    <div class="form-group">
      <label for="description">Descripción *</label>
      <textarea 
        id="description" 
        formControlName="description"
        [class.invalid]="isFieldInvalid('description')"
        rows="4"
        placeholder="Describe el producto..."></textarea>
      <span class="error-text" *ngIf="isFieldInvalid('description')">
        {{ getFieldError('description') }}
      </span>
    </div>

    <!-- Precio y Stock en fila -->
    <div class="form-row">
      <div class="form-group">
        <label for="price">Precio *</label>
        <input 
          type="number" 
          id="price" 
          formControlName="price"
          [class.invalid]="isFieldInvalid('price')"
          step="0.01"
          min="0"
          placeholder="0.00">
        <span class="error-text" *ngIf="isFieldInvalid('price')">
          {{ getFieldError('price') }}
        </span>
      </div>

      <div class="form-group">
        <label for="stock">Stock *</label>
        <input 
          type="number" 
          id="stock" 
          formControlName="stock"
          [class.invalid]="isFieldInvalid('stock')"
          min="0"
          placeholder="0">
        <span class="error-text" *ngIf="isFieldInvalid('stock')">
          {{ getFieldError('stock') }}
        </span>
      </div>
    </div>

    <!-- Categoría -->
    <div class="form-group">
      <label for="category">Categoría *</label>
      <input 
        type="text" 
        id="category" 
        formControlName="category"
        [class.invalid]="isFieldInvalid('category')"
        placeholder="Ej: Electrónica">
      <span class="error-text" *ngIf="isFieldInvalid('category')">
        {{ getFieldError('category') }}
      </span>
    </div>

    <!-- Botones -->
    <div class="form-actions">
      <button 
        type="button" 
        class="btn-cancel" 
        (click)="onCancel()"
        [disabled]="loading$ | async">
        Cancelar
      </button>
      <button 
        type="submit" 
        class="btn-submit"
        [disabled]="productForm.invalid || (loading$ | async)">
        <span *ngIf="loading$ | async" class="spinner"></span>
        {{ (loading$ | async) ? 'Guardando...' : (isEditMode ? 'Actualizar' : 'Crear') }}
      </button>
    </div>

  </form>

  <!-- Información del formulario -->
  <div class="form-info">
    <p>* Campos obligatorios</p>
  </div>
</div>
